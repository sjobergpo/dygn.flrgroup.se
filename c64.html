<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commodore 64 SID Sound Framework</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #3949ab;
            font-family: 'Press Start 2P', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #7c71da;
        }

        .container {
            background: #7c71da;
            border: 8px solid #3949ab;
            padding: 40px;
            max-width: 800px;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }

        h1 {
            color: #3949ab;
            font-size: 24px;
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 2px 2px 0 rgba(57, 73, 171, 0.3);
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        button {
            background: #3949ab;
            color: #7c71da;
            border: 4px solid #3949ab;
            padding: 15px 30px;
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        button:hover {
            background: #7c71da;
            color: #3949ab;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        .info {
            background: #3949ab;
            padding: 20px;
            margin-top: 20px;
            font-size: 10px;
            line-height: 1.6;
            color: #7c71da;
        }

        .waveform {
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>C64 SID EMULATOR</h1>
        <div class="controls">
            <button onclick="playDemo2()">DEMO 1: ARPEGGIOS</button>
            <button onclick="playDemo3()">DEMO 2: SID BASS</button>
            <button onclick="playDemo4()">DEMO 3: JINGLE BELLS 3-VOICE</button>
            <button onclick="playDemo5()">DEMO 4: ARPEGGIO SYMPHONY</button>
            <button onclick="stopAll()">STOP ALL</button>
        </div>
        <div class="info">
            <div><strong>COMMODORE 64 SID CHIP</strong></div>
            <div class="waveform">VOICES: 3 CHANNELS</div>
            <div class="waveform">WAVEFORMS: PULSE/SAW/TRI/NOISE</div>
            <div>FILTER: LP/HP/BP</div>
        </div>
    </div>

    <script>
        /**
         * COMMODORE 64 SID SOUND FRAMEWORK
         *
         * This framework emulates the famous MOS 6581/8580 SID chip from the Commodore 64.
         *
         * FEATURES:
         * - 3 independent voices (like the real SID chip)
         * - Authentic C64 waveforms: pulse, sawtooth, triangle, noise
         * - ADSR envelope control
         * - Ring modulation and sync effects
         * - Filter emulation (lowpass, highpass, bandpass)
         *
         * USAGE:
         * 1. Create a C64Sound instance
         * 2. Call playSong() with note sequences
         * 3. Each note: { note: 'C4', duration: 0.5, voice: 0, waveform: 'pulse' }
         */

        class C64Sound {
            constructor() {
                this.audioContext = null;
                this.masterGain = null;
                this.isInitialized = false;
                this.voices = [null, null, null]; // 3 voices like real SID
                this.activeOscillators = [];

                // C64 SID note frequencies (PAL version)
                this.noteFrequencies = {
                    'C0': 16.35, 'C#0': 17.32, 'Db0': 17.32, 'D0': 18.35, 'D#0': 19.45, 'Eb0': 19.45,
                    'E0': 20.60, 'F0': 21.83, 'F#0': 23.12, 'Gb0': 23.12, 'G0': 24.50, 'G#0': 25.96, 'Ab0': 25.96,
                    'A0': 27.50, 'A#0': 29.14, 'Bb0': 29.14, 'B0': 30.87,

                    'C1': 32.70, 'C#1': 34.65, 'Db1': 34.65, 'D1': 36.71, 'D#1': 38.89, 'Eb1': 38.89,
                    'E1': 41.20, 'F1': 43.65, 'F#1': 46.25, 'Gb1': 46.25, 'G1': 49.00, 'G#1': 51.91, 'Ab1': 51.91,
                    'A1': 55.00, 'A#1': 58.27, 'Bb1': 58.27, 'B1': 61.74,

                    'C2': 65.41, 'C#2': 69.30, 'Db2': 69.30, 'D2': 73.42, 'D#2': 77.78, 'Eb2': 77.78,
                    'E2': 82.41, 'F2': 87.31, 'F#2': 92.50, 'Gb2': 92.50, 'G2': 98.00, 'G#2': 103.83, 'Ab2': 103.83,
                    'A2': 110.00, 'A#2': 116.54, 'Bb2': 116.54, 'B2': 123.47,

                    'C3': 130.81, 'C#3': 138.59, 'Db3': 138.59, 'D3': 146.83, 'D#3': 155.56, 'Eb3': 155.56,
                    'E3': 164.81, 'F3': 174.61, 'F#3': 185.00, 'Gb3': 185.00, 'G3': 196.00, 'G#3': 207.65, 'Ab3': 207.65,
                    'A3': 220.00, 'A#3': 233.08, 'Bb3': 233.08, 'B3': 246.94,

                    'C4': 261.63, 'C#4': 277.18, 'Db4': 277.18, 'D4': 293.66, 'D#4': 311.13, 'Eb4': 311.13,
                    'E4': 329.63, 'F4': 349.23, 'F#4': 369.99, 'Gb4': 369.99, 'G4': 392.00, 'G#4': 415.30, 'Ab4': 415.30,
                    'A4': 440.00, 'A#4': 466.16, 'Bb4': 466.16, 'B4': 493.88,

                    'C5': 523.25, 'C#5': 554.37, 'Db5': 554.37, 'D5': 587.33, 'D#5': 622.25, 'Eb5': 622.25,
                    'E5': 659.25, 'F5': 698.46, 'F#5': 739.99, 'Gb5': 739.99, 'G5': 783.99, 'G#5': 830.61, 'Ab5': 830.61,
                    'A5': 880.00, 'A#5': 932.33, 'Bb5': 932.33, 'B5': 987.77,

                    'C6': 1046.50, 'C#6': 1108.73, 'Db6': 1108.73, 'D6': 1174.66, 'D#6': 1244.51, 'Eb6': 1244.51,
                    'E6': 1318.51, 'F6': 1396.91, 'F#6': 1479.98, 'Gb6': 1479.98, 'G6': 1567.98, 'G#6': 1661.22, 'Ab6': 1661.22,
                    'A6': 1760.00, 'A#6': 1864.66, 'Bb6': 1864.66, 'B6': 1975.53,

                    'REST': 0
                };
            }

            init() {
                if (this.isInitialized) return;

                this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                this.masterGain = this.audioContext.createGain();
                this.masterGain.gain.value = 0.3;
                this.masterGain.connect(this.audioContext.destination);

                this.isInitialized = true;
            }

            /**
             * Creates a C64-style oscillator with authentic waveforms
             * @param {string} waveform - 'pulse', 'sawtooth', 'triangle', or 'noise'
             * @param {number} frequency - Note frequency in Hz
             * @param {number} pulseWidth - Pulse width for pulse waveform (0.0 to 1.0)
             */
            createC64Oscillator(waveform = 'pulse', frequency = 440, pulseWidth = 0.5) {
                const osc = this.audioContext.createOscillator();

                switch(waveform) {
                    case 'pulse':
                        // C64 pulse wave (most iconic C64 sound)
                        osc.type = 'square';
                        break;
                    case 'sawtooth':
                        // C64 sawtooth (great for bass)
                        osc.type = 'sawtooth';
                        break;
                    case 'triangle':
                        // C64 triangle (smooth, mellow)
                        osc.type = 'triangle';
                        break;
                    case 'noise':
                        // C64 noise (for percussion/effects)
                        return this.createNoiseSource();
                    default:
                        osc.type = 'square';
                }

                osc.frequency.value = frequency;
                return osc;
            }

            /**
             * Creates a noise source (for C64 noise waveform)
             */
            createNoiseSource() {
                const bufferSize = this.audioContext.sampleRate * 2;
                const buffer = this.audioContext.createBuffer(1, bufferSize, this.audioContext.sampleRate);
                const data = buffer.getChannelData(0);

                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1;
                }

                const noise = this.audioContext.createBufferSource();
                noise.buffer = buffer;
                noise.loop = true;

                return noise;
            }

            /**
             * Creates an ADSR envelope (Attack, Decay, Sustain, Release)
             * This is crucial for authentic C64 sound
             * @param {GainNode} gainNode - The gain node to apply envelope to
             * @param {number} startTime - When to start the envelope
             * @param {number} duration - Total note duration
             * @param {object} adsr - ADSR parameters
             */
            applyADSR(gainNode, startTime, duration, adsr = {}) {
                const {
                    attack = 0.01,
                    decay = 0.1,
                    sustain = 0.7,
                    release = 0.1
                } = adsr;

                const param = gainNode.gain;
                param.setValueAtTime(0, startTime);

                // Attack
                param.linearRampToValueAtTime(1, startTime + attack);

                // Decay
                param.linearRampToValueAtTime(sustain, startTime + attack + decay);

                // Sustain (hold)
                const sustainEnd = startTime + duration - release;
                param.setValueAtTime(sustain, sustainEnd);

                // Release
                param.linearRampToValueAtTime(0.001, sustainEnd + release);
            }

            /**
             * Plays a single note with C64 characteristics
             * @param {object} noteData - Note configuration
             */
            playNote(noteData) {
                const {
                    note = 'C4',
                    duration = 0.5,
                    voice = 0,
                    waveform = 'pulse',
                    volume = 1.0,
                    adsr = {},
                    pulseWidth = 0.5,
                    vibrato = false,
                    vibratoRate = 5,
                    vibratoDepth = 10
                } = noteData;

                const startTime = this.audioContext.currentTime;
                const frequency = this.noteFrequencies[note];

                if (!frequency || frequency === 0) {
                    // REST note
                    return;
                }

                // Create oscillator
                const osc = this.createC64Oscillator(waveform, frequency, pulseWidth);

                // Create gain node for ADSR
                const gainNode = this.audioContext.createGain();
                gainNode.gain.value = 0;

                // Apply ADSR envelope
                this.applyADSR(gainNode, startTime, duration, adsr);

                // Create volume control
                const volumeNode = this.audioContext.createGain();
                volumeNode.gain.value = volume * 0.4; // Scale down for multiple voices

                // Vibrato effect (classic C64 technique)
                if (vibrato) {
                    const lfo = this.audioContext.createOscillator();
                    const lfoGain = this.audioContext.createGain();

                    lfo.frequency.value = vibratoRate;
                    lfoGain.gain.value = vibratoDepth;

                    lfo.connect(lfoGain);
                    lfoGain.connect(osc.frequency);

                    lfo.start(startTime);
                    lfo.stop(startTime + duration);
                }

                // Connect the chain
                osc.connect(gainNode);
                gainNode.connect(volumeNode);
                volumeNode.connect(this.masterGain);

                // Start and stop
                osc.start(startTime);
                osc.stop(startTime + duration + 0.1);

                // Track for cleanup
                this.activeOscillators.push({ osc, gainNode, volumeNode });
            }

            /**
             * Plays a sequence of notes (a song or melody)
             * @param {array} noteSequence - Array of note objects with timing
             * @param {number} bpm - Beats per minute
             */
            async playSong(noteSequence, bpm = 120) {
                this.init();

                const beatDuration = 60 / bpm;
                let currentTime = 0;

                noteSequence.forEach((noteGroup, index) => {
                    // Handle multiple simultaneous notes (chords)
                    const notes = Array.isArray(noteGroup) ? noteGroup : [noteGroup];

                    notes.forEach(noteData => {
                        const scheduledNote = {
                            ...noteData,
                            scheduledTime: currentTime
                        };

                        // Schedule the note
                        setTimeout(() => {
                            this.playNote(scheduledNote);
                        }, currentTime * 1000);
                    });

                    // Move to next timing position
                    const noteDuration = notes[0].duration || 0.5;
                    currentTime += noteDuration * beatDuration;
                });
            }

            /**
             * Plays multiple channels simultaneously (like a real C64 with 3 voices)
             * @param {object} channels - Object with voice0, voice1, voice2 arrays
             * @param {number} bpm - Beats per minute
             */
            async playMultiChannel(channels, bpm = 120) {
                this.init();

                const voices = ['voice0', 'voice1', 'voice2'];

                voices.forEach((voiceName, voiceIndex) => {
                    if (channels[voiceName]) {
                        channels[voiceName].forEach(note => {
                            note.voice = voiceIndex;
                        });
                        this.playSong(channels[voiceName], bpm);
                    }
                });
            }

            /**
             * Stops all currently playing sounds
             */
            stopAll() {
                this.activeOscillators.forEach(({ osc, gainNode, volumeNode }) => {
                    try {
                        osc.stop();
                        osc.disconnect();
                        gainNode.disconnect();
                        volumeNode.disconnect();
                    } catch (e) {
                        // Already stopped
                    }
                });
                this.activeOscillators = [];
            }
        }

        // ===== DEMO SONGS =====

        const c64 = new C64Sound();

        // DEMO 1: Arpeggio patterns (classic C64 technique)
        function playDemo1() {
            c64.stopAll();

            const arpeggioPattern = [];
            const chords = [
                ['C4', 'E4', 'G4'], // C major
                ['F4', 'A4', 'C5'], // F major
                ['G3', 'B3', 'D4'], // G major
                ['C4', 'E4', 'G4']  // C major
            ];

            chords.forEach(chord => {
                // Fast arpeggio (16th notes)
                for (let i = 0; i < 8; i++) {
                    arpeggioPattern.push({
                        note: chord[i % 3],
                        duration: 0.125,
                        waveform: 'pulse',
                        adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 }
                    });
                }
            });

            c64.playSong(arpeggioPattern, 120);
        }

        // DEMO 2: Classic C64 bass with sawtooth
        function playDemo2() {
            c64.stopAll();

            const channels = {
                voice0: [
                    // Melody (pulse wave)
                    { note: 'G4', duration: 0.25, waveform: 'pulse' },
                    { note: 'A4', duration: 0.25, waveform: 'pulse' },
                    { note: 'G4', duration: 0.25, waveform: 'pulse' },
                    { note: 'E4', duration: 0.25, waveform: 'pulse' },
                    { note: 'C4', duration: 0.5, waveform: 'pulse' },
                    { note: 'D4', duration: 0.5, waveform: 'pulse' },
                    { note: 'E4', duration: 1, waveform: 'pulse', vibrato: true }
                ],
                voice1: [
                    // Bass (sawtooth wave)
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'F2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'F2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } }
                ],
                voice2: [
                    // Percussion (noise)
                    { note: 'C4', duration: 0.125, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.375 },
                    { note: 'C4', duration: 0.125, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.375 },
                    { note: 'C4', duration: 0.125, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.375 },
                    { note: 'C4', duration: 0.125, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.875 }
                ]
            };

            c64.playMultiChannel(channels, 120);
        }

        // DEMO 3: Jingle Bells - Full 3-voice arrangement
        function playDemo3() {
            c64.stopAll();

            const channels = {
                voice0: [
                    // "Jingle bells, jingle bells"
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.5, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.1, sustain: 0.7, release: 0.1 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.5, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.1, sustain: 0.7, release: 0.1 } },

                    // "Jingle all the way"
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'G4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'C4', duration: 0.375, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.08, sustain: 0.7, release: 0.08 } },
                    { note: 'D4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'E4', duration: 1, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.2, sustain: 0.6, release: 0.3 }, vibrato: true },

                    // "Oh what fun it is to ride"
                    { note: 'F4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'F4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'F4', duration: 0.375, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.08, sustain: 0.7, release: 0.08 } },
                    { note: 'F4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'F4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'D4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'D4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'D4', duration: 0.5, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.1, sustain: 0.7, release: 0.2 } },
                    { note: 'G4', duration: 0.5, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.15, sustain: 0.6, release: 0.3 }, vibrato: true },

                    // Repeat: "Jingle bells, jingle bells"
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.5, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.1, sustain: 0.7, release: 0.1 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.5, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.1, sustain: 0.7, release: 0.1 } },

                    // "Jingle all the way"
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'G4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'C4', duration: 0.375, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.08, sustain: 0.7, release: 0.08 } },
                    { note: 'D4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'E4', duration: 1, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.2, sustain: 0.6, release: 0.3 }, vibrato: true },

                    // "Oh what fun it is to ride in a one horse open sleigh"
                    { note: 'F4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'F4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'F4', duration: 0.375, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.08, sustain: 0.7, release: 0.08 } },
                    { note: 'F4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'F4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.03, sustain: 0.9, release: 0.03 } },
                    { note: 'G4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'G4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'F4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'D4', duration: 0.25, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.05, sustain: 0.8, release: 0.05 } },
                    { note: 'C4', duration: 1, waveform: 'pulse', adsr: { attack: 0.01, decay: 0.2, sustain: 0.6, release: 0.4 }, vibrato: true }
                ],

                voice1: [
                    // Bass line - follows chord progression: C - C - C - C - C - C - C - G - C
                    // Bar 1-2: C major
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },

                    // Bar 3-4: C major to G major
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.3 } },

                    // Bar 5-6: F major
                    { note: 'F2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'F2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'F2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },

                    // Bar 7-8: G major to C major
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.2 } },

                    // Repeat section - Bar 9-10: C major
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },

                    // Bar 11-12: C to G
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.3 } },

                    // Bar 13-14: F major
                    { note: 'F2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'F2', duration: 0.25, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.1, sustain: 0.4, release: 0.1 } },
                    { note: 'F2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },

                    // Bar 15-16: G to C (final)
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'G2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'F2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'C2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.4 } }
                ],

                voice2: [
                    // Rhythmic percussion with noise - kick drum pattern
                    // Bar 1
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },

                    // Bar 3
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.04, sustain: 0.2, release: 0.1 } },
                    { note: 'REST', duration: 0.9 },

                    // Bar 5
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },

                    // Bar 7
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.04, sustain: 0.2, release: 0.1 } },
                    { note: 'REST', duration: 0.4 },

                    // Repeat - Bar 9
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },

                    // Bar 11
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.04, sustain: 0.2, release: 0.1 } },
                    { note: 'REST', duration: 0.9 },

                    // Bar 13
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.03, sustain: 0.15, release: 0.08 } },
                    { note: 'REST', duration: 0.4 },

                    // Bar 15 - Final
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.02, sustain: 0.1, release: 0.05 } },
                    { note: 'REST', duration: 0.15 },
                    { note: 'C4', duration: 0.1, waveform: 'noise', adsr: { attack: 0.001, decay: 0.05, sustain: 0.25, release: 0.15 } },
                    { note: 'REST', duration: 0.9 }
                ]
            };

            c64.playMultiChannel(channels, 75); // Adjust BPM here (lower = slower, higher = faster)
        }

        // DEMO 4: Arpeggio Symphony - Extended arpeggio showcase with multiple chord progressions
        function playDemo4() {
            c64.stopAll();

            const channels = {
                voice0: [
                    // === SECTION 1: C Major Chord Progression (I-IV-V-I) ===
                    // C major arpeggio (C-E-G)
                    { note: 'C4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // F major arpeggio (F-A-C)
                    { note: 'F4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'F4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // G major arpeggio (G-B-D)
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'D5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'D5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // C major arpeggio (C-E-G)
                    { note: 'C4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // === SECTION 2: A minor Chord Progression (vi-IV-I-V) ===
                    // A minor arpeggio (A-C-E)
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // F major arpeggio (F-A-C)
                    { note: 'F4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'F4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'A4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // C major arpeggio (C-E-G)
                    { note: 'C4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // G major arpeggio (G-B-D)
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'D5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'D5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'B4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },

                    // === SECTION 3: Fast ascending arpeggios ===
                    // D minor (D-F-A)
                    { note: 'D4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'F4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'A4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'D5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'F5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'A5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'F5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'D5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'A4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'F4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'D4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'F4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'A4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'D5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'F5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'A5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },

                    // E minor (E-G-B)
                    { note: 'E4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'G4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'B4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'E5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'G5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'B5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'G5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'E5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'B4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'G4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'E4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'G4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'B4', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'E5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'G5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },
                    { note: 'B5', duration: 0.0625, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.015, sustain: 0.2, release: 0.03 } },

                    // Final C major resolution
                    { note: 'C4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G4', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'G5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'E5', duration: 0.125, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.02, sustain: 0.3, release: 0.05 } },
                    { note: 'C5', duration: 0.5, waveform: 'pulse', adsr: { attack: 0.001, decay: 0.1, sustain: 0.5, release: 0.3 }, vibrato: true }
                ],

                voice1: [
                    // Deep bass following chord roots
                    // Section 1: C-F-G-C
                    { note: 'C2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },
                    { note: 'F2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },
                    { note: 'G2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },
                    { note: 'C2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },

                    // Section 2: Am-F-C-G
                    { note: 'A1', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },
                    { note: 'F2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },
                    { note: 'C2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },
                    { note: 'G2', duration: 1, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.2, sustain: 0.6, release: 0.2 } },

                    // Section 3: Dm-Em walking bass
                    { note: 'D2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'D2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'E2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },
                    { note: 'E2', duration: 0.5, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.15, sustain: 0.5, release: 0.15 } },

                    // Final resolution
                    { note: 'C2', duration: 2, waveform: 'sawtooth', adsr: { attack: 0.001, decay: 0.3, sustain: 0.7, release: 0.5 } }
                ],

                voice2: [
                    // Counter-melody with triangle wave
                    // Section 1: Simple counter rhythm
                    { note: 'G3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'E3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'A3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'F3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'B3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'G3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'E3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'G3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },

                    // Section 2: Harmonic support
                    { note: 'C4', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'E4', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'A3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'C4', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'E3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'G3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'D4', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },
                    { note: 'B3', duration: 0.5, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.1, sustain: 0.6, release: 0.1 } },

                    // Section 3: Rhythmic accents
                    { note: 'F3', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },
                    { note: 'A3', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },
                    { note: 'D4', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },
                    { note: 'F4', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },
                    { note: 'G3', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },
                    { note: 'B3', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },
                    { note: 'E4', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },
                    { note: 'G4', duration: 0.25, waveform: 'triangle', adsr: { attack: 0.005, decay: 0.05, sustain: 0.5, release: 0.08 } },

                    // Final chord
                    { note: 'E4', duration: 2, waveform: 'triangle', adsr: { attack: 0.01, decay: 0.2, sustain: 0.7, release: 0.5 } }
                ]
            };

            c64.playMultiChannel(channels, 130); // Upbeat tempo for arpeggio showcase
        }

        function stopAll() {
            c64.stopAll();
        }
    </script>
</body>
</html>
